<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Lista de Chaves</title>
  <style>
    /* estilos visuais aqui ‚Äî j√° inclu√≠dos com modo escuro, filtros, badges, bot√£o flutuante */
    /* ... (use os estilos que j√° te enviei anteriormente, ou posso te mandar novamente) ... */
  </style>
</head>
<body>
  <div class="container">
    <h1>Lista de Chaves</h1>
    <p class="lead">Use a busca para filtrar por n√∫mero, descri√ß√£o ou categoria.</p>
    <div class="filters" id="filters"></div>
    <input id="search" class="search" placeholder="üîé Buscar por n√∫mero, nome ou v√°rios termos..." autofocus>
    <ul id="results" class="list" aria-live="polite"></ul>
    <div id="nores" class="nores" style="display:none">Nenhum resultado encontrado</div>
    <div class="footer">Arquivo: <strong>lista-de-chaves.html</strong></div>
  </div>
  <div class="theme-toggle" id="themeToggle">üåô</div>
  <div class="back-top" id="backTop">‚Üë</div>
  <script>
document.addEventListener("DOMContentLoaded", () => {
  // lista de entradas
  const entries = [
    "[LABORAT√ìRIOS]",
    "46 Laborat√≥rio Diet√©tica / T√©cnica de Alimentos",
    "47 Laborat√≥rio Fisiologia e Avalia√ß√£o Nutricional",
    // ... (todas as entradas que voc√™ j√° tem) ...
    "[CHAVES PR√âDIO II]",
    "1 Sala de aula n¬∫ 01",
    "2 Sala de aula n¬∫ 02",
    "95 Quadro Geral de For√ßa"
  ];

  const structured = entries.map(e => {
    const m = e.match(/^(\d{1,3})\s*[‚Äì‚Äî-]?\s*(.*)$/);
    if (m) return { num: m[1], text: m[2] || '', raw: e };
    return { num: '', text: e, raw: e };
  });

  const categories = [
    "Todos",
    "LABORAT√ìRIOS",
    "DEPARTAMENTOS DIVERSOS",
    "COORDENA√á√ïES",
    "SANIT√ÅRIOS",
    "SA√çDAS DE EMERG√äNCIA E C√îMODOS DA LIMPEZA",
    "BARRAC√ÉO E GIN√ÅSIO",
    "CENTROS EDUCACIONAIS",
    "DIVERSOS",
    "CHAVES PR√âDIO II"
  ];

  function render(list, activeCategory = "Todos") {
    const ul = document.getElementById('results');
    const nores = document.getElementById('nores');
    ul.innerHTML = '';
    nores.style.display = 'none';

    let currentSection = '';
    let inPredioII = false;
    let renderedSomething = false;

    for (const it of list) {
      if (it.raw.startsWith('[') && it.raw.endsWith(']')) {
        currentSection = it.raw.slice(1, -1);
        inPredioII = (currentSection === 'CHAVES PR√âDIO II');
        if (activeCategory === "Todos" || currentSection === activeCategory) {
          const li = document.createElement('li');
          li.className = 'item';
          li.innerHTML = `<span class="badge">üîπ ${currentSection}</span>`;
          ul.appendChild(li);
          renderedSomething = true;
        }
        continue;
      }

      if (activeCategory !== "Todos" && currentSection !== activeCategory) continue;

      const li = document.createElement('li');
      li.className = 'item';
      const num = it.num ? `<strong>${it.num}</strong>` : '';
      const p2 = inPredioII ? `<span class="p2-tag">üè¢ P2</span>` : '';
      li.innerHTML = `${p2}${num} ‚Äî <span>${it.text || it.raw}</span>`;
      ul.appendChild(li);
      renderedSomething = true;
    }

    if (!renderedSomething) nores.style.display = 'block';
  }

  function setupFilters() {
    const filtersDiv = document.getElementById('filters');
    filtersDiv.innerHTML = '';
    categories.forEach(cat => {
      const btn = document.createElement('button');
      btn.className = 'filter-btn';
      btn.textContent = cat;
      btn.dataset.category = cat;
      if (cat === "Todos") btn.classList.add('active');
      filtersDiv.appendChild(btn);
    });

    filtersDiv.addEventListener('click', (e) => {
      if (!e.target.classList.contains('filter-btn')) return;
      document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
      e.target.classList.add('active');
      applySearchAndFilter();
    });
  }

  function applySearchAndFilter() {
    const input = document.getElementById('search');
    const q = input.value.trim().toLowerCase();
    const activeBtn = document.querySelector('.filter-btn.active');
    const activeCategory = activeBtn ? activeBtn.dataset.category : "Todos";
    const terms = q ? q.split(/\s+/).filter(Boolean) : [];
    let list = structured;

    if (terms.length > 0) {
      list = structured.filter(it => {
        const haystack = (it.raw + ' ' + (it.text || '') + ' ' + (it.num || '')).toLowerCase();
        return terms.every(t => haystack.includes(t));
      });
    }

    render(list, activeCategory);
  }

  function loadTheme() {
    const saved = localStorage.getItem('theme') || 'light';
    const themeToggle = document.getElementById('themeToggle');
    if (saved === 'dark') {
      document.body.classList.add('dark');
      themeToggle.textContent = '‚òÄÔ∏è';
    } else {
      document.body.classList.remove('dark');
      themeToggle.textContent = 'üåô';
    }

    themeToggle.addEventListener('click', () => {
      const isDark = document.body.classList.toggle('dark');
      themeToggle.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    });
  }

  function setupBackTop() {
    const backTop = document.getElementById('backTop');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 200) {
        backTop.classList.add('visible');
      } else {
        backTop.classList.remove('visible');
      }
    });
    backTop.addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });
  }

  setupFilters();
  render(structured);
  loadTheme();
  setupBackTop();

  const searchInput = document.getElementById('search');
  searchInput.addEventListener('input', applySearchAndFilter);
});
</script>
</body>
</html>
